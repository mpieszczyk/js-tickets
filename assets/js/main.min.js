!function(){function a(){var a="https://api.mongolab.com/api/1/databases/case-add-form/collections/case-add-form-items?apiKey=VLJbjCcSjJW8puhnqe4oFQfJ"+sessionStorage.getItem("sysPass");$.ajax({url:a}).done(function(a){var t;$.each(a,function(a,e){var s="<a id='setCase' href='' data-id='"+e._id.$oid+"' data-casenum='"+e.casenum+"' data-fname='"+e.fname+"' data-lname='"+e.lname+"' data-date='"+e.date+"' data-place='"+e.place+"' data-person='"+e.person+"' data-describe='"+e.describe+"'><i class='fa fa-pencil-square fa-lg' aria-hidden='true' data-toggle='modal' data-target='#addCaseFormModal'></i></a>",i="<a id='delCase' href='' data-id='"+e._id.$oid+"'><i class='fa fa-trash fa-lg' aria-hidden='true'></i></a></td>";t+="<tr class='table-active'>",t+="<td style='display: table-cell;'>"+e.casenum+"</td>",t+="<td style='display: table-cell;'>"+e.fname+"</td>",t+="<td style='display: table-cell;'>"+e.lname+"</td>",t+="<td style='display: table-cell;'>"+e.date+"</td>",t+="<td style='display: table-cell;'>"+e.place+"</td>",t+="<td style='display: table-cell;'>"+e.person+"</td>",t+="<td style='display: table-cell;'>"+e.describe+"</td>",t+="<td style='display: table-cell;'>"+s+"&nbsp;"+i,t+="</tr>"}),$("#tableBodyData").html(t),e()})}function e(){var a,e;a=0,e=parseInt($("#numOfRows").val()),$("#myTab tbody tr").length,$("#myTab tr:gt(0)").each(function(){++a>e?$(this).hide():a<=e&&$(this).show()}),$(".pagination").html(""),function(){var a=parseInt($("#numOfRows").val()),e=$("#myTab tbody tr").length;if(e>a)for(var t=Math.ceil(e/a),s=1;s<=t;)$(".pagination").append("<li class='page-item' data-page="+s+"><a style='user-select: none;'' class='page-link'>"+s+++"</a></li>").show();else $(".pagination").html("");$(".pagination li:first-child").addClass("active")}(),$(".pagination li").on("click",function(){var a=$(this).attr("data-page"),e=parseInt($("#numOfRows").val()),t=0;$(".pagination li").removeClass("active"),$(this).addClass("active"),$("#myTab tr:gt(0)").each(function(){++t>e*a||t<=e*a-e?$(this).hide():$(this).show()})})}function t(a,e){var t,s=$(a).find("tr:gt(0)").toArray().sort((t=$(e).index(),function(a,e){var s=$(a).children("td").eq(t).html(),i=$(e).children("td").eq(t).html();return $.isNumeric(s)&&$.isNumeric(i)?s-i:s.localeCompare(i)}));$(e).hasClass("asc")?($(e).removeClass("asc").addClass("desc"),$(e).find("i.fa").removeClass("fa-sort-amount-asc").addClass("fa-sort-amount-desc"),s=s.reverse()):($(e).removeClass("desc").addClass("asc"),$(e).find("i.fa").removeClass("fa-sort-amount-desc").addClass("fa-sort-amount-asc"));for(var i=0;i<s.length;i++)$(a).append(s[i])}$(document).ready(function(){sessionStorage.getItem("sysPass")?($("#sectionTable").removeClass("invisible"),$("#sectionLoginForm").remove(),a()):$("#sectionLoginForm button:submit").click(function(e){e.preventDefault();var t=$("input:password").val();null===sessionStorage.getItem("sysPass")&&(sessionStorage.setItem("sysPass",t),a(),$("#sectionTable").removeClass("invisible"),$("#sectionLoginForm").remove())}),sessionStorage.removeItem("currentCaseId"),$("body").on("click","#setCase",function(a){a.preventDefault(),sessionStorage.setItem("currentCaseId",$(this).data("id")),$("#inputFormCaseNumber").val($(this).data("casenum")),$("#inputFormFirstName").val($(this).data("fname")),$("#inputFormLastName").val($(this).data("lname")),$("#inputFormCaseDate").val($(this).data("date")),$("#inputFormCasePlace").val($(this).data("place")),$("#inputFormCasePerson").val($(this).data("person")),$("#inputFormCaseDesc").val($(this).data("describe")),$("#btn").html("AKTUALIZUJ"),$("#formTitle").html("Aktualizuj wybraną pozycję")}),$("body").on("click","#delCase",function(e){e.preventDefault();var t="https://api.mongolab.com/api/1/databases/case-add-form/collections/case-add-form-items/"+$(this).data("id")+"?apiKey=VLJbjCcSjJW8puhnqe4oFQfJmXAw30Qy";$.ajax({url:t,type:"DELETE",async:!0,timeout:3e5}).done(function(e){alert("Usunięto!"),a()})}),$("#search").keyup(function(){var a=$(this).val().toLowerCase();$.each($("#myTab tbody tr"),function(){-1===$(this).text().toLowerCase().indexOf(a)?$(this).hide():$(this).show()})}),$("#btn").on("click",function(e){e.preventDefault(),$(this).html("DODAJ"),$("#formTitle").html("Dodaj nową pozycję"),$(":input select, textarea").each(function(){if(""===$(this).val())alert("Pola nie mogą być puste");else{var e={},t=$("#formCaseAdd").serializeArray();if($.each(t,function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),null!=sessionStorage.getItem("currentCaseId"))var s="https://api.mongolab.com/api/1/databases/case-add-form/collections/case-add-form-items/"+sessionStorage.getItem("currentCaseId")+"?apiKey=VLJbjCcSjJW8puhnqe4oFQfJmXAw30Qy",i="PUT";else s="https://api.mongolab.com/api/1/databases/case-add-form/collections/case-add-form-items?apiKey=VLJbjCcSjJW8puhnqe4oFQfJmXAw30Qy",i="POST";$.ajax({url:s,type:i,data:JSON.stringify(e),contentType:"application/json;charset=utf-8"}).done(function(e){alert("Dodano!"),a()})}}),$("#formCaseAdd").find("input, select, textarea").val("")}),$("#numOfRows").on("change",function(){e()}),$("th").on("click",function(){$("i.fa").removeClass("fa-sort-amount-desc"),$("i.fa").removeClass("fa-sort-amount-asc"),t($("#myTab"),$(this))}),$("body").on("click","#formClose",function(){sessionStorage.removeItem("currentCaseId"),$("#formCaseAdd").find("input, select, textarea").val(""),$("#formTitle").html("Dodaj nową pozycję"),$("#btn").html("DODAJ")})})}();
